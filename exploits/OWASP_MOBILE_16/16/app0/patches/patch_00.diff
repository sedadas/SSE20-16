diff -N -c -r src/app/src/main/java/at/ac/tuwien/sse/owaspm2/LoggedInActivity.java src_fixed/app/src/main/java/at/ac/tuwien/sse/owaspm2/LoggedInActivity.java
*** src/app/src/main/java/at/ac/tuwien/sse/owaspm2/LoggedInActivity.java	2020-05-19 10:54:28.000000000 +0200
--- src_fixed/app/src/main/java/at/ac/tuwien/sse/owaspm2/LoggedInActivity.java	2020-05-19 11:54:40.000000000 +0200
***************
*** 8,16 ****
  import android.widget.Button;
  import android.widget.TextView;
  
- import at.ac.tuwien.sse.owaspm2.exceptions.ExternalStorageException;
- import at.ac.tuwien.sse.owaspm2.manager.ExternalAuthenticationStorageManager;
  import at.ac.tuwien.sse.owaspm2.manager.IAuthenticationStorageManager;
  
  public class LoggedInActivity extends AppCompatActivity {
  
--- 8,15 ----
  import android.widget.Button;
  import android.widget.TextView;
  
  import at.ac.tuwien.sse.owaspm2.manager.IAuthenticationStorageManager;
+ import at.ac.tuwien.sse.owaspm2.manager.SharedPrefsAuthenticationStorageManager;
  
  public class LoggedInActivity extends AppCompatActivity {
  
***************
*** 24,34 ****
          Intent intent = getIntent();
          String username = intent.getStringExtra("Username");
  
!         try {
!             authStorageManager = new ExternalAuthenticationStorageManager(this);
!         } catch (ExternalStorageException ex) {
!             this.finishAndRemoveTask();
!         }
  
          TextView textViewWelcomeMessage = findViewById(R.id.tvWelcomeMessage);
          textViewWelcomeMessage.setText("Hi " + username + "!");
--- 23,29 ----
          Intent intent = getIntent();
          String username = intent.getStringExtra("Username");
  
!         authStorageManager = new SharedPrefsAuthenticationStorageManager(this);
  
          TextView textViewWelcomeMessage = findViewById(R.id.tvWelcomeMessage);
          textViewWelcomeMessage.setText("Hi " + username + "!");
diff -N -c -r src/app/src/main/java/at/ac/tuwien/sse/owaspm2/MainActivity.java src_fixed/app/src/main/java/at/ac/tuwien/sse/owaspm2/MainActivity.java
*** src/app/src/main/java/at/ac/tuwien/sse/owaspm2/MainActivity.java	2020-05-19 11:34:32.000000000 +0200
--- src_fixed/app/src/main/java/at/ac/tuwien/sse/owaspm2/MainActivity.java	2020-05-19 12:01:30.000000000 +0200
***************
*** 14,22 ****
  import at.ac.tuwien.sse.owaspm2.controller.IAuthenticationController;
  import at.ac.tuwien.sse.owaspm2.controller.MockAuthenticationController;
  import at.ac.tuwien.sse.owaspm2.entities.AuthenticationData;
- import at.ac.tuwien.sse.owaspm2.exceptions.ExternalStorageException;
- import at.ac.tuwien.sse.owaspm2.manager.ExternalAuthenticationStorageManager;
  import at.ac.tuwien.sse.owaspm2.manager.IAuthenticationStorageManager;
  
  public class MainActivity extends AppCompatActivity {
  
--- 14,21 ----
  import at.ac.tuwien.sse.owaspm2.controller.IAuthenticationController;
  import at.ac.tuwien.sse.owaspm2.controller.MockAuthenticationController;
  import at.ac.tuwien.sse.owaspm2.entities.AuthenticationData;
  import at.ac.tuwien.sse.owaspm2.manager.IAuthenticationStorageManager;
+ import at.ac.tuwien.sse.owaspm2.manager.SharedPrefsAuthenticationStorageManager;
  
  public class MainActivity extends AppCompatActivity {
  
***************
*** 33,47 ****
  
          loginController = new MockAuthenticationController();
  
!         try {
!             authStorageManager = new ExternalAuthenticationStorageManager(this);
!         } catch (ExternalStorageException ex) {
!             this.finishAndRemoveTask();
!         }
  
          // Check if there are stored authentication information and try to perform a login.
!         AuthenticationData authData = authStorageManager.load();
!         if (loginController.login(authData)) {
              startLoggedInActivity(authData.getUsername());
          }
  
--- 32,42 ----
  
          loginController = new MockAuthenticationController();
  
!         authStorageManager = new SharedPrefsAuthenticationStorageManager(this);
  
          // Check if there are stored authentication information and try to perform a login.
!         final AuthenticationData authData = authStorageManager.load();
!         if (loginController.validateSession(authData)) {
              startLoggedInActivity(authData.getUsername());
          }
  
***************
*** 67,72 ****
--- 62,68 ----
  
                  // Save the authentication information if the "Remember me!" checkbox is checked.
                  if (checkBoxSaveCredentials.isChecked()) {
+                     authenticationData.setSession(loginController.getSession());
                      authStorageManager.save(authenticationData);
                  }
  
diff -N -c -r src/app/src/main/java/at/ac/tuwien/sse/owaspm2/manager/SharedPrefsAuthenticationStorageManager.java src_fixed/app/src/main/java/at/ac/tuwien/sse/owaspm2/manager/SharedPrefsAuthenticationStorageManager.java
*** src/app/src/main/java/at/ac/tuwien/sse/owaspm2/manager/SharedPrefsAuthenticationStorageManager.java	1970-01-01 01:00:00.000000000 +0100
--- src_fixed/app/src/main/java/at/ac/tuwien/sse/owaspm2/manager/SharedPrefsAuthenticationStorageManager.java	2020-05-19 11:56:32.000000000 +0200
***************
*** 0 ****
--- 1,49 ----
+ package at.ac.tuwien.sse.owaspm2.manager;
+ 
+ import android.content.Context;
+ import android.content.SharedPreferences;
+ 
+ import at.ac.tuwien.sse.owaspm2.entities.AuthenticationData;
+ 
+ public class SharedPrefsAuthenticationStorageManager implements IAuthenticationStorageManager {
+ 
+     private static final String PREFERENCES_FILE_KEY = "sp_owasp_m2";
+     private static final String KEY_SESSION = "session";
+     private static final String KEY_USERNAME = "username";
+ 
+     private SharedPreferences sharedPrefs;
+ 
+     public SharedPrefsAuthenticationStorageManager(Context context) {
+         sharedPrefs = context.getSharedPreferences(PREFERENCES_FILE_KEY, Context.MODE_PRIVATE);
+     }
+ 
+     @Override
+     public void save(AuthenticationData authenticationData) {
+         SharedPreferences.Editor editor = sharedPrefs.edit();
+         editor.putString(KEY_SESSION, authenticationData.getSession());
+         editor.putString(KEY_USERNAME, authenticationData.getUsername());
+         editor.commit();
+     }
+ 
+     @Override
+     public AuthenticationData load() {
+         if (!sharedPrefs.contains(KEY_SESSION)) {
+             return null;
+         }
+ 
+         String session = sharedPrefs.getString(KEY_SESSION, null);
+         String username = sharedPrefs.getString(KEY_USERNAME, null);
+ 
+         AuthenticationData authData = new AuthenticationData(username, null);
+         authData.setSession(session);
+ 
+         return authData;
+     }
+ 
+     @Override
+     public void delete() {
+         SharedPreferences.Editor editor = sharedPrefs.edit();
+         editor.clear();
+         editor.commit();
+     }
+ }
diff -N -c -r src/app/src/main/res/values/strings.xml src_fixed/app/src/main/res/values/strings.xml
*** src/app/src/main/res/values/strings.xml	2020-05-05 21:26:58.000000000 +0200
--- src_fixed/app/src/main/res/values/strings.xml	2020-05-19 11:57:36.000000000 +0200
***************
*** 1,3 ****
  <resources>
!     <string name="app_name">OWASP-M2</string>
  </resources>
--- 1,3 ----
  <resources>
!     <string name="app_name">OWASP-M2 (Fixed)</string>
  </resources>
